var self_eut_hid=false;timepicker_setup_obj={minuteStep:15,template:false,snapToStep:true,defaultTime:false,disableFocus:true,disableMousewheel:true,explicitMode:true};$(function(){init()});function init(){FastClick.attach(document.body);$.ajaxSetup({beforeSend:function(b,a){if(!csrfSafeMethod(a.type)&&!this.crossDomain){b.setRequestHeader("X-CSRFToken",csrftoken)}}});$.material.init();initTimePickers();initMoments();initSelfEutFromStorage();initUIHandlers()}function initTimePickers(){$(".timepicker-input").timepicker(timepicker_setup_obj)}function initMoments(){moment.locale("zh-cn");$.each($(".date-str"),function(c,b){var a=$(b).html();var e=moment(a,"YYYY/MM/DD");var d=e.calendar();$(b).html(d)})}function initUIHandlers(){$(".add-time-slot").on("click",function(){var a=$(" <div class='timeslot-group'>                        <div class='col-xs-6 col-md-6 col-lg-2 set-precise-time-cell'>                                <div class='input-group'>                                    <input type='text' class='text-center timepicker-input start-time form-control form-control-pink-A200'                                           placeholder='开始时间' data-hint='智能识别,空白默认全天' data-date='"+$(this).attr("data-date")+"'>                                    <span class='input-group-addon' style='padding:0px; padding-bottom: 15px;'>                                        <i class='icon-btn-connector mdi-content-remove'></i>                                    </span>                                </div>                        </div>                         <div class='col-xs-6 col-md-6 col-lg-2 set-precise-time-cell'>                                <div class='input-group'>                                    <input type='text'                                           class=' text-center timepicker-input end-time form-control form-control-pink-A200'                                           placeholder='结束时间' data-hint='智能识别,可留白''                                           data-date='{{ get_date_str.grouper }}' style=''>                                    <span class='input-group-addon' style='padding:0px; padding-bottom: 15px;'>                                        <i class='icon-btn mdi-content-clear delete-time-slot'></i>                                    </span>                                </div>                            </div>                            </div>");a.insertBefore($(this).parent());initTimePickers();$.material.init()});$("#dates-div").on("click",".delete-time-slot",function(){console.log("clicked");$(this).closest(".timeslot-group").velocity("fadeOut",{duration:500}).promise().done(function(){$(this).remove()})});$("#submit-timeslots").on("click",function(){submitNewEventTimesToServer()});$("#dates-div").timepicker().on("changeTime.timepicker",".timepicker-input",function(f){var a;var b;if($(this).hasClass("end-time")){b=$(this);a=$(this).closest(".timeslot-group").find(".start-time")}else{a=$(this);b=$(this).closest(".timeslot-group").find(".end-time")}if(a.val()!=""&&b.val()!=""){var d=moment("1992/6/30 "+a.val(),"YYYY/MM/DD h:mm A");var c=moment("1992/6/30 "+b.val(),"YYYY/MM/DD h:mm A");console.log(d);console.log(c);console.log(c-d)}})}function initSelfEutFromStorage(){if(typeof(Storage)!=="undefined"){self_eut_hid=localStorage.getItem(event_hid)}}function submitNewEventTimesToServer(){timeslot_str_arr=[];$(".timepicker-input").each(function(){var d=$(this).val();if(typeof d!=="undefined"){var b=$(this).attr("data-date");var c={time_str:d,date_str:b};timeslot_str_arr.push(c)}});var a={timeslot_str_json:JSON.stringify(timeslot_str_arr)};if(self_eut_hid){a.self_eut_hid=self_eut_hid}console.log(timeslot_str_arr);$.post(set_times_for_precise_time_event_url,a,function(b){window.location.href=b.url})};